extends ../../components/base/_skeleton
include ../../components/rd-navbar/_rd-navbar

block variables
  - pageName = title;
  - htmlClass.push('page-small-footer');

block page
  header.section.page-header
    +rd-navbar

  section.section-xs
    .container
      .row.justify-content-center
        .col-lg-8
          .panel
            .panel-header
              h5.panel-title
                span.panel-icon.linearicons-user-plus
                = ' '
                span= title
            .panel-body
              form(role='form' class='stat-form' method='POST' action='/users/add')
                // CSRF
                if typeof csrfToken !== 'undefined'
                  input(type='hidden', name='_csrf', value=csrfToken)
                .row
                  if userError && userError.length
                    .col-12.mb-4
                      +alert({close:false}).alert-danger.alert-sm
                        span.alert-icon.fa-exclamation-triangle
                        if Array.isArray(userError)
                          each e in userError
                            span= e
                            br
                        else
                          span= userError

                  if userSuccess && userSuccess.length
                    .col-12.mb-4
                      +alert({close:false}).alert-success.alert-sm
                        span.alert-icon.linearicons-checkmark-circle
                        if Array.isArray(userSuccess)
                          each m in userSuccess
                            span= m
                            br
                        else
                          span= userSuccess

                  // Ліва колонка
                  .col-xl-6
                    .form-group
                      label.form-label(for='firstName') Імʼя:
                      .input-group
                        .input-group-prepend
                          span.input-group-text.linearicons-user
                        input#firstName.form-control(type='text', name='firstName', required)

                    .form-group
                      label.form-label(for='email') Емейл:
                      .input-group
                        .input-group-prepend
                          span.input-group-text.linearicons-envelope
                        input#email.form-control(type='email', name='email', required)

                    .form-group
                      label.form-label(for='telegramUsername') Телеграм:
                      .input-group
                        .input-group-prepend
                          span.input-group-text.linearicons-paper-plane
                        input#telegramUsername.form-control(type='text', name='telegramUsername', placeholder='@username')

                  // Права колонка
                  .col-xl-6
                    .form-group
                      label.form-label(for='lastName') Прізвище:
                      .input-group
                        .input-group-prepend
                          span.input-group-text.linearicons-user
                        input#lastName.form-control(type='text', name='lastName', required)

                    .form-group
                      label.form-label(for='password') Пароль:
                      .input-group.password-toggle
                        .input-group-prepend
                          span.input-group-text.linearicons-lock
                        input#password.form-control(
                          type='password'
                          name='password'
                          required
                          minlength="8"
                          autocomplete='new-password'
                        )
                        .input-group-append
                          button#genPwdBtn.btn.btn-info.linearicons-rotation-lock(type='button' data-toggle='tooltip', data-original-title='Згенерувати пароль')
                          button.btn.btn-light(type='button', data-toggle='pw', data-target='#password', aria-label='Показати/приховати пароль')
                            span.linearicons-eye

                    .form-group
                      label.form-label(for='department') Відділ:
                      .input-group
                        .input-group-prepend
                          span.input-group-text.linearicons-lan
                        select#department.form-control(name='department', required)
                          if departments && departments.length
                            each d in departments
                              option(value=d.value)= d.label || d.value
                          else
                            option(value='Media Buying' selected) Media Buying

                  .col-12.mt-4
                    button.btn.btn-primary.submit-btn.w-100.mb-4(type='submit') Створити
                    a.btn.btn-light(href='/users')
                      span.mdi-keyboard-backspace.mr-2
                      span До списку

    block scripts
      script(defer src='/components/base/custom/pw-generator.js')
      script.
        document.addEventListener('DOMContentLoaded', function () {
          PasswordTools.init({
            input:  '#password',
            toggle: '#togglePwd',
            gen:    '#genPwdBtn',
            hint:   '#pwd_hint',
            length: 14
          });
        });

  include ../layout/footer
